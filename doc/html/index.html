<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DIY Auto-Correlator: DIY Teensy Correlator Project Repository</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DIY Auto-Correlator
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Auto-Correlator Card implementation using Teensy 4.x microcontrollers.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DIY Teensy Correlator Project Repository </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Author - Yatharth Bhasin</p>
<p>License: &ndash; (this repo is private and unlicensed) </p><hr/>
<p>Online <em>doxygen</em> documentation Link (auto-updated): <a href="https://yatharthb97.github.io/Correlator/index.html">https://yatharthb97.github.io/Correlator/index.html</a></p>
<p>PlateformIO documentation: <a href="https://docs.platformio.org/en/latest/">https://docs.platformio.org/en/latest/</a></p>
<p>Local documentation can be generated in the <code>doc</code> subdirectory : <code>&gt;&gt; doxygen CorrDoxyfile</code></p>
<p>Doxygen documentation: <a href="https://www.doxygen.nl/manual/index.html">https://www.doxygen.nl/manual/index.html</a> </p><hr/>
<p>â†’ Photon Statistics Device: <b>Multi-modal</b> device that is built with a framework of **"feature lines"**, that individually contain a set of features that can be used simultaneously. The features can be be selected with the option <code>"Feature Line"</code> in the <code>config.json</code> file. Set of valid feature lines include:</p>
<ol type="1">
<li><code>"ACF"</code> - Autocorrelation function and related calculations</li>
<li><code>"Interarrival"</code> - Interarrival statistics</li>
<li><code>"Sampler"</code> - Samples the counter value at periodic intervals and maintains a running mean of the counter values.</li>
</ol>
<h3>Usage</h3>
<ol type="1">
<li>Select the correct options and set the required values in <code>config.json</code> file.</li>
<li>Compile and push code to the device after saving the <code>config.json</code> file.</li>
<li>Run the PC side software (instructions below). <hr/>
</li>
</ol>
<ul>
<li>The board (microcontroller) settings are present in the file <code>plateformio.ini</code>. This file can be generated by using <code>PlateformIO</code>.</li>
<li>The module settings are present in the file <code>config.json</code>. This file is autogenerated if it is absent in the root directory. Missing fields are also added to the file during compile time with default values, and a warning message is generated.</li>
</ul>
<h3><a class="el" href="classErrors.html">Errors</a> and Debugging options ==Incomplete==</h3>
<h3>Emulation and Testing</h3>
<ul>
<li>The software modules can be tested/simulated on a PC. The files <code><a class="el" href="test_8cpp.html">test.cpp</a></code>, <code><a class="el" href="pseudoSerial_8hpp.html">pseudoSerial.hpp</a></code>, and <code><a class="el" href="pseudoSerial_8cpp.html">pseudoSerial.cpp</a></code> in the subdirectory <code>./code/software/</code> provide functionality to do so. The macro <code>CORR_SIMULATION</code> must be set during compilation to enable the contents of this file.</li>
<li><p class="startli">The file <code><a class="el" href="test_8cpp.html">test.cpp</a></code> contain module by module tests for the software modules. <code><a class="el" href="pseudoSerial_8hpp.html">pseudoSerial.hpp</a></code>, and <code><a class="el" href="pseudoSerial_8cpp.html">pseudoSerial.cpp</a></code> emulate the serial port on the device.</p>
<p class="startli">Compile:</p>
</li>
</ul>
<div class="fragment"><div class="line">g++ test.cpp pseudoSerial.cpp -D CORR_SIMULATION</div></div><!-- fragment --><ul>
<li>The subdirectory <code>./full_emulator</code>/ includes a complete emulator for the multitau module that operates with the python GUI. ==Incomplete==<ul>
<li>The module can be fed data from a saved file or the counter values can be randomly generated.</li>
</ul>
</li>
</ul>
<h2>Feature Lines (Device Modes)</h2>
<p>Feature Lines are specific <em>modes</em> for the device. This is a framework that arranges all the different features and tests in a neat and accessible manner.</p>
<h3>Common Features</h3>
<ul>
<li><p class="startli"><code>"Enable Sync Code"</code> - A specific synchronization code (set by <code>"Sync Code"</code> option) is added to the start of each struct that is transmitted from the device. At the receiver end, the software verifies this code and generates and error message if the code is not correct. The error means that the struct is misaligned and the data that is received cannot be used.</p>
<p class="startli">One way to emulate this error is to change the <code>config.json</code> file and start the PC software without compiling and pushing the changed configuration to the device.</p>
</li>
</ul>
<h3>Feature Line 1 - <code>ACF</code> (Gate Counting)</h3>
<p>This is the main feature line. This mode supports the following features which can be selectively be enabled from the configuration file. The features have zero-footprint on performance when disabled, similarly, each feature adds an overhead to the performance of the device.</p>
<p><em>Device ready</em> state is indicated by the <em>RED LED</em> and <em>Device running</em> state is indicated by the <em>GREEN LED</em> on the Panel.</p>
<ul>
<li><code>"Enable ACF"</code> : Enable Auto-correlation calculation</li>
<li><code>"Enable Count Rate"</code> - Enable Count Rate Calculation</li>
<li><code>"Enable PC Histogram"</code> - Enable Photon Counting Histogram</li>
<li><code>"Enable Performance Counters"</code> - Enable Performance Counters for Serial Output and ACF calculation. This counts the number of clock cycles for the particular operations and maintains a mean value. <hr/>
</li>
<li><code>"Enable Points Norm"</code> - Enable simple points normalization (under review).</li>
<li><code>"Enable Mean Norm"</code> - Enable normalization based on mean count rate. (under review)</li>
</ul>
<h3>Feature Line 2 - <code>Interarrival</code> (Tight Polling)</h3>
<p><em>Device ready</em> state is indicated by the <em>BLUE LED</em> and <em>Device running</em> state is indicated by the <em>WHITE LED</em> on the Panel.</p>
<p>==Implementation Pending==</p>
<h3>Feature Line 3 - <code>Sampler</code> (Gate Counting)</h3>
<p><em>Device ready</em> state is indicated by the <em>WHITE LED</em> and <em>Device running</em> state is indicated by the <em>GREEN LED</em> on the Panel.</p>
<p>This feature samples the Counter value at periodic intervals (set by <code>"Sampling Delay ms"</code>) and prints the counter value, mean counter value, etc with line separation. Hence, the <code>"Enable Synchronization Code"</code> is ignored, since the synchronization is performed via the endline characters <code>\r\n</code>.</p>
<p>Typical output: cv: counter value (sampled), m: mean, c: count of read values, a: accumulate</p>
<div class="fragment"><div class="line">cv: 10  m: 0.10  c: 2667270000  a: 268435456.00</div></div><!-- fragment --><h2>Module Description (<code>Incomplete</code>)</h2>
<h3>Pure Software Modules</h3>
<p>This folder contains the implementation of the software correlator that will be used on Teensy. The file descriptions are as follows:</p>
<ul>
<li><code>Lin_ACorr_RT_Base.hpp</code> - Base (Interface) for Linear Correlators</li>
<li><code><a class="el" href="Lin__ACorr__RT__Teensy_8hpp.html">Lin_ACorr_RT_Teensy.hpp</a></code> - Implementation specific to Teensy</li>
<li><code><a class="el" href="multi__tau_8hpp.html">multi_tau.hpp</a></code> - Teensy specific implementation of multi-tau Auto-correlator</li>
<li><code><a class="el" href="accumulator_8hpp.html">accumulator.hpp</a></code> - Adapter object used by Multi Tau ACorr</li>
<li><code><a class="el" href="discarder_8hpp.html">discarder.hpp</a></code> - Adapter object used by Multi Tau ACorr</li>
<li><code><a class="el" href="simpler__circular__buffer_8hpp.html">simpler_circular_buffer.hpp</a></code> - Simple circlar buffer used for storing the cout values.</li>
<li><code><a class="el" href="types_8hpp.html">types.hpp</a></code> - Contains the <code>typedef</code> of the abstracted typenames<ul>
<li><code>counter_t</code> - Type returned by the Counter module</li>
<li><code>index_t</code> - Type used to index arrays and buffers in the implementation</li>
</ul>
</li>
<li><code><a class="el" href="test_8cpp.html">test.cpp</a></code> - File used for tsting</li>
<li><code>circlar_buffer.hpp</code> - Another implementation of circular buffer (unsued right now)</li>
<li><code>Lin_CrossCorr_RT_Base.hpp</code> - Base interface for Linear Cross Correlators</li>
<li><code><a class="el" href="Lin__CrossCorr__RT__Teensy_8hpp.html">Lin_CrossCorr_RT_Teensy.hpp</a></code> - Teensy specific Liner Cross Correlator interface</li>
</ul>
<h3>Hardware Modules (are specific to Teensy 4.1)</h3>
<p>File descriptions:</p>
<ul>
<li><code><a class="el" href="pit_8hpp.html">pit.hpp</a></code> - Defines <code>class <a class="el" href="classPITController.html" title="Interface for PIT timers on Teensy 4.x microcontrollers. ">PITController</a></code> that provides an abstraction layer on the PIT timer controls.</li>
<li><code><a class="el" href="qtmr1_8hpp.html">qtmr1.hpp</a></code> - Defines 'class QTMR1Controller' that provides an abstraction layer on the QTMR1 timer controls.</li>
<li><code><a class="el" href="lifetime__timer_8hpp.html">lifetime_timer.hpp</a></code> - Interface for using PIT timers in chained mode to create a 64-bit lifetime counter</li>
</ul>
<h3>Common Interface</h3>
<ul>
<li><code>modules.hpp</code> - Defines functions that represent highest-abstracted modules in the system.</li>
<li><code><a class="el" href="errors_8hpp.html">errors.hpp</a></code> - Defines common error codes and error generating functions.</li>
<li><code><a class="el" href="utilities_8hpp.html">utilities.hpp</a></code> - Contains some utility functions</li>
</ul>
<h3>PC Application</h3>
<p>This portion is written in python 3.</p>
<p>The PC application can be launched : <code>&gt;&gt; python ./code/pc_app/photon_statistics.py</code> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
