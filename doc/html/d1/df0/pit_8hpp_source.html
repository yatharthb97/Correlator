<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DIY Auto-Correlator and Photon Statistics: code/hardware/pit.hpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DIY Auto-Correlator and Photon Statistics
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Auto-Correlator Card implementation using Teensy 4.x microcontrollers.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_050edd66366d13764f98250ef6db77f6.html">code</a></li><li class="navelem"><a class="el" href="../../dir_433973328a9fb1c8f55eb2f608025f72.html">hardware</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">pit.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d1/df0/pit_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#pragma once</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d52/errors_8hpp.html">errors.hpp</a>&quot;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ChID&gt;</div><div class="line"><a name="l00007"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html">    7</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d8/d03/classPITController.html">PITController</a></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="comment">//Period values are in microseconds (us)</span></div><div class="line"><a name="l00013"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#a549601e7c66941d7872a6e7d38ed9563">   13</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d8/d03/classPITController.html#a549601e7c66941d7872a6e7d38ed9563">Actual_period</a> = 0; </div><div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#a9de0af49a52145c8d2a8f4e90a519b60">   14</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d8/d03/classPITController.html#a9de0af49a52145c8d2a8f4e90a519b60">Req_period</a> = 0; </div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#ae3d74bb18e5b22769e895f592cb16129">   16</a></span>&#160;    uint32_t <a class="code" href="../../d8/d03/classPITController.html#ae3d74bb18e5b22769e895f592cb16129">Clk_freq</a> = uint32_t(24 * 1e6); </div><div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#ad253f0ac646573e5b08e050b6fab5e32">   17</a></span>&#160;    uint32_t <a class="code" href="../../d8/d03/classPITController.html#ad253f0ac646573e5b08e050b6fab5e32">LoadVal</a> = 0; </div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#a53778fe7e47ac9741bef0bc190e0646a">   18</a></span>&#160;    <span class="keyword">const</span> <span class="keyword">static</span> constexpr uint32_t <a class="code" href="../../d8/d03/classPITController.html#a53778fe7e47ac9741bef0bc190e0646a">PIT_MAX_COUNTER</a> = 4294967295; </div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#ad9ef4f151495076fad7b0c556e48b117">   20</a></span>&#160;<a class="code" href="../../d8/d03/classPITController.html#ad9ef4f151495076fad7b0c556e48b117">PITController</a>()</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{ static_assert(ChID &lt;=3, <span class="stringliteral">&quot;No such PIT channel exists!&quot;</span>); }</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#aa742977692efbc075b52a5dbd6533230">   24</a></span>&#160;    <span class="keywordtype">void</span> <span class="keyword">static</span> <a class="code" href="../../d8/d03/classPITController.html#aa742977692efbc075b52a5dbd6533230">enable_PITs</a>() __attribute__((always_inline))</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    {</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        PIT_MCR = 0x00; <span class="comment">//Write 0 is ON</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    } </div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#a5e1bf9f8053a51c68f0ff2178ab56954">   30</a></span>&#160;    <span class="keywordtype">void</span> <span class="keyword">static</span> <a class="code" href="../../d8/d03/classPITController.html#a5e1bf9f8053a51c68f0ff2178ab56954">disable_PITs</a>() __attribute__((always_inline))</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    {</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        PIT_MCR = 0x01; <span class="comment">//Write 1 is OFF</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    }</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#a24b7ea02555967ef945ab87aae338574">   36</a></span>&#160;    <span class="keywordtype">void</span> <span class="keyword">static</span> <a class="code" href="../../d8/d03/classPITController.html#a24b7ea02555967ef945ab87aae338574">pause_resume_PITs</a>() __attribute__((always_inline))</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        PIT_MCR ^= PIT_MCR_FRZ;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    }</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#a4dae1ed0ada64ebc03665e8f39795e7e">   43</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/d03/classPITController.html#a4dae1ed0ada64ebc03665e8f39795e7e">start</a>() __attribute__((always_inline))</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        IMXRT_PIT_CHANNELS[ChID].TCTRL |= PIT_TCTRL_TEN; <span class="comment">//Set BIT</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#a5a6e2b00c6355934531a77a62660bec7">   49</a></span>&#160;    <span class="keywordtype">void</span>  <a class="code" href="../../d8/d03/classPITController.html#a5a6e2b00c6355934531a77a62660bec7">stop</a>() __attribute__((always_inline))</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        IMXRT_PIT_CHANNELS[ChID].TCTRL &amp;= ~PIT_TCTRL_TEN; <span class="comment">//Unset BIT</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    }</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#aaf7a79129a4ea5af057ea8f537b7ae9f">   58</a></span>&#160;    <a class="code" href="../../df/d52/errors_8hpp.html#a4e8c0d09726859e3d3369c0da5a1aa7f">Error_t</a> <a class="code" href="../../d8/d03/classPITController.html#aaf7a79129a4ea5af057ea8f537b7ae9f">set_gate_time</a>(<span class="keywordtype">double</span> gt_microseconds) __attribute__((flatten))</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordtype">double</span> ldval_ = gt_microseconds * this-&gt;Clk_freq * 1e-6;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        uint32_t ldval = ceil(ldval_);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        this-&gt;Req_period = gt_microseconds;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        </div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">if</span>(ldval &gt; PIT_MAX_COUNTER)</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            this-&gt;LoadVal = <a class="code" href="../../d8/d03/classPITController.html#a53778fe7e47ac9741bef0bc190e0646a">PIT_MAX_COUNTER</a>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            IMXRT_PIT_CHANNELS[ChID].LDVAL = <a class="code" href="../../d8/d03/classPITController.html#ad253f0ac646573e5b08e050b6fab5e32">LoadVal</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            this-&gt;Actual_period = ((this-&gt;LoadVal+1) * this-&gt;<a class="code" href="../../d8/d03/classPITController.html#a2b64ce8a01dc1254002c4ff3c384a6fd">tick_period_us</a>());</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../df/d52/errors_8hpp.html#a4e8c0d09726859e3d3369c0da5a1aa7fa8347bab2e74e4a640d76c916306a1a36">Error_t::Counter_Overflow</a>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ldval &lt; 0)</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            this-&gt;LoadVal = <a class="code" href="../../d8/d03/classPITController.html#a53778fe7e47ac9741bef0bc190e0646a">PIT_MAX_COUNTER</a>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            IMXRT_PIT_CHANNELS[ChID].LDVAL = <a class="code" href="../../d8/d03/classPITController.html#ad253f0ac646573e5b08e050b6fab5e32">LoadVal</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            this-&gt;Actual_period = ((this-&gt;LoadVal+1) * this-&gt;<a class="code" href="../../d8/d03/classPITController.html#a2b64ce8a01dc1254002c4ff3c384a6fd">tick_period_us</a>());</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../df/d52/errors_8hpp.html#a4e8c0d09726859e3d3369c0da5a1aa7fa02b02f5e5e61f24acdd91338b95997da">Error_t::Counter_Underflow</a>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        {   </div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            this-&gt;LoadVal =  uint32_t((ldval)) - 1;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            IMXRT_PIT_CHANNELS[ChID].LDVAL = <a class="code" href="../../d8/d03/classPITController.html#ad253f0ac646573e5b08e050b6fab5e32">LoadVal</a>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            this-&gt;Actual_period = ((this-&gt;LoadVal+1) * this-&gt;<a class="code" href="../../d8/d03/classPITController.html#a2b64ce8a01dc1254002c4ff3c384a6fd">tick_period_us</a>());</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../df/d52/errors_8hpp.html#a4e8c0d09726859e3d3369c0da5a1aa7fa505a83f220c02df2f85c3810cd9ceb38">Error_t::Success</a>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#a3fedb5ff5a44b664e8132f4e2836b155">   93</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d8/d03/classPITController.html#a3fedb5ff5a44b664e8132f4e2836b155">period_error_us</a>() const __attribute__((always_inline))</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">return</span> (this-&gt;Req_period - this-&gt;Actual_period);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#a2b64ce8a01dc1254002c4ff3c384a6fd">   99</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../d8/d03/classPITController.html#a2b64ce8a01dc1254002c4ff3c384a6fd">tick_period_us</a>() __attribute__((always_inline))</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">return</span> 1e6 / double(this-&gt;Clk_freq);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#a7cb352b2deb5bba48b8e2f0671a66801">  108</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">static</span> <a class="code" href="../../d8/d03/classPITController.html#a7cb352b2deb5bba48b8e2f0671a66801">get_xbar_in_pin</a>() __attribute__((always_inline))</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">if</span>(ChID == 0)</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        { <span class="keywordflow">return</span> 56; }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ChID == 1)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        { <span class="keywordflow">return</span> 57; }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ChID == 2)</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        { <span class="keywordflow">return</span> 58; }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ChID == 3)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        { <span class="keywordflow">return</span> 59; }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#af1a21e0b3f9a57e247aa40c457e15ee3">  124</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/d03/classPITController.html#af1a21e0b3f9a57e247aa40c457e15ee3">interrupt</a>() __attribute__((always_inline))</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        IMXRT_PIT_CHANNELS[ChID].TCTRL |= PIT_TCTRL_TIE; <span class="comment">//Set BIT</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#a6e36c84f319e52e5a14ca20f299b64b5">  130</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/d03/classPITController.html#a6e36c84f319e52e5a14ca20f299b64b5">no_interrupt</a>() __attribute__((always_inline))</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        IMXRT_PIT_CHANNELS[ChID].TCTRL &amp;= ~PIT_TCTRL_TIE; <span class="comment">//Clear BIT</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#aa94b6dc081d453c8dda54c3ade4b3d94">  137</a></span>&#160;    <span class="keywordtype">void</span> <span class="keyword">static</span> <a class="code" href="../../d8/d03/classPITController.html#aa94b6dc081d453c8dda54c3ade4b3d94">set_interrupt</a>(<span class="keywordtype">void</span> (*<a class="code" href="../../d0/dc7/featureline1_8hpp.html#a4fc8f622f69a856a51bd3d4b1b42233a">isr_fn</a>)(), <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> priority ) __attribute__((always_inline))</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="comment">//_assert_(priority &lt;= 255, &quot;Priority value should be below 255.&quot;);</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        NVIC_ENABLE_IRQ(IRQ_PIT);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        NVIC_SET_PRIORITY(IRQ_PIT, priority);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        attachInterruptVector(IRQ_PIT, <a class="code" href="../../d0/dc7/featureline1_8hpp.html#a4fc8f622f69a856a51bd3d4b1b42233a">isr_fn</a>);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#ae3f9c981e88cced34153234475de5646">  146</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/d03/classPITController.html#ae3f9c981e88cced34153234475de5646">clear_interrupt_flag</a>() __attribute__((always_inline))</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        IMXRT_PIT_CHANNELS[ChID].TFLG = 1; <span class="comment">//Clear by writing 1 (TIF is the only field in the register)</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#a63e67e2ebfd6ceb5f5e38d9bd6a54754">  154</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/d03/classPITController.html#a63e67e2ebfd6ceb5f5e38d9bd6a54754">sel_FBUS_clock</a>() __attribute__((always_inline))</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        CCM_CSCMR1 &amp;= ~CCM_CSCMR1_PERCLK_CLK_SEL; <span class="comment">//Clear CCM-Peripheral clock gate bit -&gt; gate down</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        Clk_freq = F_BUS_ACTUAL; <span class="comment">//Set Equal to Peripheral Bus frequency  </span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="../../d8/d03/classPITController.html#adb0d04fa23f4ebd20d2f495a86af3ccd">  162</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d8/d03/classPITController.html#adb0d04fa23f4ebd20d2f495a86af3ccd">sel_24MHz_clock</a>() __attribute__((always_inline))</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          CCM_CSCMR1 |= CCM_CSCMR1_PERCLK_CLK_SEL; <span class="comment">//Set CCM-Peripheral clock gate bit -&gt; gate up</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          this-&gt;Clk_freq = uint32_t(24*1e6); <span class="comment">//24MHz</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}; <span class="comment">//End of class PIT Controller</span></div><div class="ttc" id="errors_8hpp_html"><div class="ttname"><a href="../../df/d52/errors_8hpp.html">errors.hpp</a></div></div>
<div class="ttc" id="classPITController_html_aa742977692efbc075b52a5dbd6533230"><div class="ttname"><a href="../../d8/d03/classPITController.html#aa742977692efbc075b52a5dbd6533230">PITController::enable_PITs</a></div><div class="ttdeci">static void enable_PITs() __attribute__((always_inline))</div><div class="ttdoc">Enable all PIT channels. </div><div class="ttdef"><b>Definition:</b> pit.hpp:24</div></div>
<div class="ttc" id="classPITController_html_aaf7a79129a4ea5af057ea8f537b7ae9f"><div class="ttname"><a href="../../d8/d03/classPITController.html#aaf7a79129a4ea5af057ea8f537b7ae9f">PITController::set_gate_time</a></div><div class="ttdeci">Error_t set_gate_time(double gt_microseconds) __attribute__((flatten))</div><div class="ttdoc">Sets the gate time after which the counter returns to zero and marks the end of onegate interval...</div><div class="ttdef"><b>Definition:</b> pit.hpp:58</div></div>
<div class="ttc" id="classPITController_html_a2b64ce8a01dc1254002c4ff3c384a6fd"><div class="ttname"><a href="../../d8/d03/classPITController.html#a2b64ce8a01dc1254002c4ff3c384a6fd">PITController::tick_period_us</a></div><div class="ttdeci">double tick_period_us() __attribute__((always_inline))</div><div class="ttdoc">Returns the value of one Tick - Minimum resolution of the timer. </div><div class="ttdef"><b>Definition:</b> pit.hpp:99</div></div>
<div class="ttc" id="classPITController_html_a63e67e2ebfd6ceb5f5e38d9bd6a54754"><div class="ttname"><a href="../../d8/d03/classPITController.html#a63e67e2ebfd6ceb5f5e38d9bd6a54754">PITController::sel_FBUS_clock</a></div><div class="ttdeci">void sel_FBUS_clock() __attribute__((always_inline))</div><div class="ttdoc">Sets the clock source frequency of all PIT channels to the value F_BUS_ACTUAL (= F_CPU_ACTUAL / 4 ) w...</div><div class="ttdef"><b>Definition:</b> pit.hpp:154</div></div>
<div class="ttc" id="classPITController_html_a6e36c84f319e52e5a14ca20f299b64b5"><div class="ttname"><a href="../../d8/d03/classPITController.html#a6e36c84f319e52e5a14ca20f299b64b5">PITController::no_interrupt</a></div><div class="ttdeci">void no_interrupt() __attribute__((always_inline))</div><div class="ttdoc">Disable Interrupts that are triggered after one gate time completion. </div><div class="ttdef"><b>Definition:</b> pit.hpp:130</div></div>
<div class="ttc" id="classPITController_html_a549601e7c66941d7872a6e7d38ed9563"><div class="ttname"><a href="../../d8/d03/classPITController.html#a549601e7c66941d7872a6e7d38ed9563">PITController::Actual_period</a></div><div class="ttdeci">double Actual_period</div><div class="ttdoc">Actual Time Period set by the device due to finite resolution. </div><div class="ttdef"><b>Definition:</b> pit.hpp:13</div></div>
<div class="ttc" id="classPITController_html_a24b7ea02555967ef945ab87aae338574"><div class="ttname"><a href="../../d8/d03/classPITController.html#a24b7ea02555967ef945ab87aae338574">PITController::pause_resume_PITs</a></div><div class="ttdeci">static void pause_resume_PITs() __attribute__((always_inline))</div><div class="ttdoc">Pause/Resume - Toggle all PIT Channels. </div><div class="ttdef"><b>Definition:</b> pit.hpp:36</div></div>
<div class="ttc" id="classPITController_html_af1a21e0b3f9a57e247aa40c457e15ee3"><div class="ttname"><a href="../../d8/d03/classPITController.html#af1a21e0b3f9a57e247aa40c457e15ee3">PITController::interrupt</a></div><div class="ttdeci">void interrupt() __attribute__((always_inline))</div><div class="ttdoc">Enable Interruptsthat are triggered after one gate time completion. </div><div class="ttdef"><b>Definition:</b> pit.hpp:124</div></div>
<div class="ttc" id="classPITController_html_a5e1bf9f8053a51c68f0ff2178ab56954"><div class="ttname"><a href="../../d8/d03/classPITController.html#a5e1bf9f8053a51c68f0ff2178ab56954">PITController::disable_PITs</a></div><div class="ttdeci">static void disable_PITs() __attribute__((always_inline))</div><div class="ttdoc">Disable all PIT Channels. </div><div class="ttdef"><b>Definition:</b> pit.hpp:30</div></div>
<div class="ttc" id="classPITController_html_a5a6e2b00c6355934531a77a62660bec7"><div class="ttname"><a href="../../d8/d03/classPITController.html#a5a6e2b00c6355934531a77a62660bec7">PITController::stop</a></div><div class="ttdeci">void stop() __attribute__((always_inline))</div><div class="ttdoc">stop counting on the timer. </div><div class="ttdef"><b>Definition:</b> pit.hpp:49</div></div>
<div class="ttc" id="errors_8hpp_html_a4e8c0d09726859e3d3369c0da5a1aa7fa02b02f5e5e61f24acdd91338b95997da"><div class="ttname"><a href="../../df/d52/errors_8hpp.html#a4e8c0d09726859e3d3369c0da5a1aa7fa02b02f5e5e61f24acdd91338b95997da">Error_t::Counter_Underflow</a></div><div class="ttdoc">Passed Value caused a counter underflow. </div></div>
<div class="ttc" id="classPITController_html_a53778fe7e47ac9741bef0bc190e0646a"><div class="ttname"><a href="../../d8/d03/classPITController.html#a53778fe7e47ac9741bef0bc190e0646a">PITController::PIT_MAX_COUNTER</a></div><div class="ttdeci">static const constexpr uint32_t PIT_MAX_COUNTER</div><div class="ttdoc">Constant - Maximum possible counter value. 32 bit counter. </div><div class="ttdef"><b>Definition:</b> pit.hpp:18</div></div>
<div class="ttc" id="classPITController_html_ae3f9c981e88cced34153234475de5646"><div class="ttname"><a href="../../d8/d03/classPITController.html#ae3f9c981e88cced34153234475de5646">PITController::clear_interrupt_flag</a></div><div class="ttdeci">void clear_interrupt_flag() __attribute__((always_inline))</div><div class="ttdoc">Clears the interrupt flag and hence prepares the timer for the next gate interval. The clearing has to be done manually. If the flag is not cleared, the interrupt will be called again and again. </div><div class="ttdef"><b>Definition:</b> pit.hpp:146</div></div>
<div class="ttc" id="classPITController_html_adb0d04fa23f4ebd20d2f495a86af3ccd"><div class="ttname"><a href="../../d8/d03/classPITController.html#adb0d04fa23f4ebd20d2f495a86af3ccd">PITController::sel_24MHz_clock</a></div><div class="ttdeci">void sel_24MHz_clock() __attribute__((always_inline))</div><div class="ttdoc">Sets the source clock frequency of all PIT channels to 24 MHz which is the default oscillator clock...</div><div class="ttdef"><b>Definition:</b> pit.hpp:162</div></div>
<div class="ttc" id="classPITController_html_ad9ef4f151495076fad7b0c556e48b117"><div class="ttname"><a href="../../d8/d03/classPITController.html#ad9ef4f151495076fad7b0c556e48b117">PITController::PITController</a></div><div class="ttdeci">PITController()</div><div class="ttdef"><b>Definition:</b> pit.hpp:20</div></div>
<div class="ttc" id="classPITController_html_a4dae1ed0ada64ebc03665e8f39795e7e"><div class="ttname"><a href="../../d8/d03/classPITController.html#a4dae1ed0ada64ebc03665e8f39795e7e">PITController::start</a></div><div class="ttdeci">void start() __attribute__((always_inline))</div><div class="ttdoc">Start counting on the timer. </div><div class="ttdef"><b>Definition:</b> pit.hpp:43</div></div>
<div class="ttc" id="classPITController_html_aa94b6dc081d453c8dda54c3ade4b3d94"><div class="ttname"><a href="../../d8/d03/classPITController.html#aa94b6dc081d453c8dda54c3ade4b3d94">PITController::set_interrupt</a></div><div class="ttdeci">static void set_interrupt(void(*isr_fn)(), unsigned int priority) __attribute__((always_inline))</div><div class="ttdoc">Sets a common ISR and its priority for all PIT Channels. </div><div class="ttdef"><b>Definition:</b> pit.hpp:137</div></div>
<div class="ttc" id="errors_8hpp_html_a4e8c0d09726859e3d3369c0da5a1aa7fa8347bab2e74e4a640d76c916306a1a36"><div class="ttname"><a href="../../df/d52/errors_8hpp.html#a4e8c0d09726859e3d3369c0da5a1aa7fa8347bab2e74e4a640d76c916306a1a36">Error_t::Counter_Overflow</a></div><div class="ttdoc">Passed Value caused a counter overflow. </div></div>
<div class="ttc" id="classPITController_html_ad253f0ac646573e5b08e050b6fab5e32"><div class="ttname"><a href="../../d8/d03/classPITController.html#ad253f0ac646573e5b08e050b6fab5e32">PITController::LoadVal</a></div><div class="ttdeci">uint32_t LoadVal</div><div class="ttdoc">The value loaded in to the counter during after overflow. </div><div class="ttdef"><b>Definition:</b> pit.hpp:17</div></div>
<div class="ttc" id="classPITController_html_a3fedb5ff5a44b664e8132f4e2836b155"><div class="ttname"><a href="../../d8/d03/classPITController.html#a3fedb5ff5a44b664e8132f4e2836b155">PITController::period_error_us</a></div><div class="ttdeci">double period_error_us() const __attribute__((always_inline))</div><div class="ttdoc">Returns the error in the gate timing period due to the finite resolution of the timers.  Error in microseconds. </div><div class="ttdef"><b>Definition:</b> pit.hpp:93</div></div>
<div class="ttc" id="classPITController_html_a7cb352b2deb5bba48b8e2f0671a66801"><div class="ttname"><a href="../../d8/d03/classPITController.html#a7cb352b2deb5bba48b8e2f0671a66801">PITController::get_xbar_in_pin</a></div><div class="ttdeci">unsigned static int get_xbar_in_pin() __attribute__((always_inline))</div><div class="ttdoc">Returns the correspoding XBAR1-A Input Pins for the corresponding channel TRIGGER signal...</div><div class="ttdef"><b>Definition:</b> pit.hpp:108</div></div>
<div class="ttc" id="classPITController_html"><div class="ttname"><a href="../../d8/d03/classPITController.html">PITController</a></div><div class="ttdoc">Interface for PIT timers on Teensy 4.x microcontrollers. </div><div class="ttdef"><b>Definition:</b> pit.hpp:7</div></div>
<div class="ttc" id="errors_8hpp_html_a4e8c0d09726859e3d3369c0da5a1aa7fa505a83f220c02df2f85c3810cd9ceb38"><div class="ttname"><a href="../../df/d52/errors_8hpp.html#a4e8c0d09726859e3d3369c0da5a1aa7fa505a83f220c02df2f85c3810cd9ceb38">Error_t::Success</a></div><div class="ttdoc">No error. </div></div>
<div class="ttc" id="classPITController_html_a9de0af49a52145c8d2a8f4e90a519b60"><div class="ttname"><a href="../../d8/d03/classPITController.html#a9de0af49a52145c8d2a8f4e90a519b60">PITController::Req_period</a></div><div class="ttdeci">double Req_period</div><div class="ttdoc">Time Period requested by the user. </div><div class="ttdef"><b>Definition:</b> pit.hpp:14</div></div>
<div class="ttc" id="errors_8hpp_html_a4e8c0d09726859e3d3369c0da5a1aa7f"><div class="ttname"><a href="../../df/d52/errors_8hpp.html#a4e8c0d09726859e3d3369c0da5a1aa7f">Error_t</a></div><div class="ttdeci">Error_t</div><div class="ttdoc">Enumarates the error codes thrown by the different modules. </div><div class="ttdef"><b>Definition:</b> errors.hpp:16</div></div>
<div class="ttc" id="featureline1_8hpp_html_a4fc8f622f69a856a51bd3d4b1b42233a"><div class="ttname"><a href="../../d0/dc7/featureline1_8hpp.html#a4fc8f622f69a856a51bd3d4b1b42233a">isr_fn</a></div><div class="ttdeci">void isr_fn()</div><div class="ttdoc">ISR function used for processing counter values. </div><div class="ttdef"><b>Definition:</b> featureline1.hpp:31</div></div>
<div class="ttc" id="classPITController_html_ae3d74bb18e5b22769e895f592cb16129"><div class="ttname"><a href="../../d8/d03/classPITController.html#ae3d74bb18e5b22769e895f592cb16129">PITController::Clk_freq</a></div><div class="ttdeci">uint32_t Clk_freq</div><div class="ttdoc">Clock frequency used by the timer. Initalized to 24MHz → default oscillator clock. </div><div class="ttdef"><b>Definition:</b> pit.hpp:16</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 14 2021 11:21:50 for DIY Auto-Correlator and Photon Statistics by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
